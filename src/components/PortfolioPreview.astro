---
const featuredProjects = [
  { 
    title: 'E-commerce Premium', 
    location: 'LANZAROTE',
    slug: 'ecommerce-premium', 
    image: 'https://images.unsplash.com/photo-1523275335684-37898b6baf30?q=80&w=1999&auto=format&fit=crop',
  },
  { 
    title: 'SaaS Dashboard', 
    location: 'MADRID',
    slug: 'saas-dashboard', 
    image: 'https://images.unsplash.com/photo-1460925895917-afdab827c52f?q=80&w=2015&auto=format&fit=crop',
  },
  { 
    title: 'App de Clima IA', 
    location: 'BARCELONA',
    slug: 'weather-ia', 
    image: 'https://images.unsplash.com/photo-1454165205744-3b78555e5572?q=80&w=2070&auto=format&fit=crop',
  }
];
---

<section id="portfolio-gallery" class="relative min-h-screen bg-deep-black flex items-center justify-center overflow-hidden">
  
  <!-- Dynamic Background Images (Cross-fading) -->
  <div class="gallery-bg-container absolute inset-0 z-0">
    <!-- Static Base Background -->
    <div class="absolute inset-0 bg-[#011314]"></div>
    
    {featuredProjects.map((project, index) => (
      <div 
        class="gallery-bg-img absolute inset-0 opacity-0 pointer-events-none"
        style={`background-image: url(${project.image})`}
        data-index={index}
      >
        <div class="absolute inset-0 bg-black/75"></div>
      </div>
    ))}
  </div>

  <div class="relative z-10 w-full max-w-7xl mx-auto px-4 py-24 flex flex-col items-center">
    
    <!-- Central Text Group -->
    <div class="text-group text-center mb-16 md:mb-24">
      <div class="label text-xs tracking-[0.5em] text-white/50 uppercase mb-4 opacity-0 portfolio-fade-up">
        Nuestros proyectos
      </div>
      <h2 class="text-4xl md:text-7xl font-black text-white leading-none tracking-tighter opacity-0 portfolio-fade-up">
        EL ARTE DE <br class="hidden md:block"/> 
        <em class="text-lime italic">CREAR DIGITAL</em>
      </h2>
    </div>

    <!-- Link Group (Interactive Items) -->
    <div class="link-group flex flex-col md:flex-row items-center md:items-stretch justify-center gap-12 md:gap-0 w-full">
      {featuredProjects.map((project, index) => (
        <a 
          href={`/portfolio/${project.slug}`}
          class="gallery-link group flex-1 flex flex-col items-center text-center space-y-6 md:space-y-8 px-8 py-12 md:border-l border-white/10 first:border-l-0 opacity-0 portfolio-fade-up"
          data-index={index}
        >
          <div class="label text-[10px] md:text-xs tracking-[0.3em] text-white/40 uppercase group-hover:text-lime transition-colors duration-500">
            {project.location}
          </div>
          
          <div class="link__text text-xl md:text-2xl lg:text-3xl font-bold text-white uppercase tracking-tight group-hover:scale-105 transition-transform duration-500">
            {project.title}
          </div>

          <span class="square-icon w-12 h-12 md:w-16 md:h-16 border border-white/20 flex items-center justify-center rotate-45 group-hover:border-lime group-hover:bg-lime/10 transition-all duration-500 mt-6">
            <!-- Icon remains straight inside rotated container -->
            <svg class="w-6 h-6 md:w-8 md:h-8 -rotate-45 text-white group-hover:text-lime transition-colors" viewBox="0 0 29 37" fill="none">
              <path d="M10.4302 10.8652L18.1225 18.3588L10.4302 26.0512" stroke="currentColor" stroke-width="1.5"></path>
            </svg>
          </span>
        </a>
      ))}
    </div>
  </div>
</section>

<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener('DOMContentLoaded', () => {
    const links = document.querySelectorAll('.gallery-link');
    const backgrounds = document.querySelectorAll('.gallery-bg-img');

    // Hover Logic: Change Background
    links.forEach((link, index) => {
      link.addEventListener('mouseenter', () => {
        backgrounds.forEach((bg, bgIdx) => {
          gsap.to(bg, {
            opacity: bgIdx === index ? 1 : 0,
            scale: bgIdx === index ? 1.05 : 1,
            duration: 1.2,
            ease: "power2.inOut"
          });
        });
      });

      // Optional: hide all on mouseleave of the whole link group
    });

    // Entrance Animations
    gsap.to('.portfolio-fade-up', {
      opacity: 1,
      y: 0,
      duration: 1.2,
      stagger: 0.2,
      ease: 'power4.out',
      scrollTrigger: {
        trigger: '#portfolio-gallery',
        start: 'top 60%',
      }
    });
  });
</script>

<style>
  .gallery-bg-img {
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    transition: transform 1.2s ease-out;
  }

  .portfolio-fade-up {
    transform: translateY(30px);
  }

  .gallery-link {
    text-decoration: none;
    transition: background-color 0.5s ease;
  }

  .gallery-link:hover {
    background-color: rgba(255, 255, 255, 0.02);
  }

  /* Specific Rosa Hotels square frame rotation logic */
  .square-icon {
    transform: rotate(45deg);
  }
</style>
